This document outlines the agents (compiled WASM modules, JavaScript wrappers, etc.) generated and utilized by the `RoMarketplace` Color Extraction project. The primary goal of this project is to provide a high-performance, WebAssembly-compiled K-means clustering algorithm for identifying dominant image colors, accessible from JavaScript.

## 1. Rust K-Means WASM Module

This is the core of our project. It's a Rust library compiled to WebAssembly, implementing the K-means clustering algorithm.

*   **Agent Name:** `ro-color-wasm` (or a similar name reflecting your chosen project name)
*   **Technology:** Rust, WebAssembly
*   **Compilation Tool:** `wasm-pack`
*   **Purpose:**
    *   Performs the K-means clustering on image pixel data.
    *   Calculates the centroids, which represent the dominant colors.
    *   Exposes functions for initialization, data feeding, and retrieving results.
*   **Key Rust Crates Used:**
    *   `kmeans-lite` (or your chosen K-means implementation crate)
    *   `wasm-bindgen`: For generating Rust-to-JavaScript bindings.
    *   `console_error_panic_hook`: For better error reporting in the browser console.
    *   *(Add any other significant crates here, e.g., for image processing if done in Rust)*
*   **Key WASM Functions Exposed (via `wasm-bindgen`):**
    *   `init()`: Initializes the WASM module and potentially the K-means state.
    *   `process_image(width: u32, height: u32, pixel_data: Vec<u8>) -> Vec<u8>`: Takes raw pixel data and returns the dominant colors (e.g., as an array of RGB values).
    *   `new(k: usize) -> Self`: Constructor for the K-means algorithm.
    *   `add_point(&mut self, point: &[f64])`: Adds a data point (pixel RGB value) to the algorithm.
    *   `cluster(&mut self) -> Vec<Vec<f64>>`: Runs the clustering and returns the centroids.
    *   *(List the actual functions you export from your `lib.rs` `#[wasm_bindgen]` block.)*
*   **Build Command Example:**
    ```bash
    wasm-pack build --target web --out-name ro_color_wasm --out-dir pkg
    ```
    *   `--target web`: Specifies that the output should be consumable by web applications.
    *   `--out-name ro_color_wasm`: Sets the JavaScript module name.
    *   `--out-dir pkg`: Specifies the directory where the compiled artifacts (WASM file, JS bindings, etc.) will be placed.
*   **Output Artifacts (in `pkg/` directory):**
    *   `ro_color_wasm_bg.wasm`: The compiled WebAssembly binary.
    *   `ro_color_wasm.js`: JavaScript bindings generated by `wasm-bindgen`.
    *   `ro_color_wasm.d.ts`: TypeScript definitions for the bindings.
    *   `package.json`: Metadata for npm publishing (if applicable).

## 2. JavaScript Wrapper/API (Optional but Recommended)

While `wasm-bindgen` generates JS bindings, it's often beneficial to create a cleaner, higher-level JavaScript API that abstracts away the direct WASM calls. This makes it easier for other parts of `RoMarketplace` to use the functionality.

*   **Agent Name:** `ColorExtractorAPI` (or similar)
*   **Technology:** JavaScript / TypeScript
*   **Purpose:**
    *   Handles loading and instantiating the WASM module.
    *   Provides user-friendly methods like `extractDominantColors(imageData)` which might take an `ImageData` object or a Blob URL.
    *   Manages memory between JavaScript and WASM (e.g., copying pixel data to WASM's linear memory).
    *   Handles potential errors during WASM execution.
*   **Key Functions:**
    *   `loadModule()`: Asynchronously loads the WASM module.
    *   `extractDominantColors(imageSource)`: Orchestrates the process of getting pixel data and calling the WASM function.
    *   `getWasmInstance()`: Provides access to the instantiated WASM module if needed.
*   **Example Usage (Conceptual):**
    ```javascript
    import { ColorExtractorAPI } from './path-to-js-api'; // Or import from pkg if published

    const api = new ColorExtractorAPI();

    async function processImageFile(file) {
      await api.loadModule();
      const dominantColors = await api.extractDominantColors(file);
      console.log('Dominant colors:', dominantColors);
    }
    ```

## 3. Example Usage / Demo Application

To showcase the functionality and ensure the WASM module works correctly within a web environment.

*   **Agent Name:** `DemoApp`
*   **Technology:** HTML, CSS, JavaScript (or a framework like React, Vue, etc.)
*   **Purpose:**
    *   Provides a UI for users to upload an image.
    *   Integrates with the `ColorExtractorAPI` (or directly with the WASM bindings).
    *   Displays the original image and the extracted dominant colors.
    *   Demonstrates the performance benefits.

## Integration with RoMarketplace

The `ro-color-wasm` WASM module, via its JavaScript API, will be integrated into the `RoMarketplace` frontend application. It will be responsible for:

*   Analyzing product images to determine their primary colors.
*   Potentially powering color-based filtering or search features.
*   Enhancing the visual presentation of products.
